{
  "name": "修复 Vditor 编辑模式",
  "description": "让编辑模式使用 vditor 正常加载文档并允许编辑，关闭 vditor 自带的模式切换",
  "branchName": "ralph/fix-vditor-edit-mode",
  "userStories": [
    {
      "id": "US-001",
      "title": "修改 Vditor 默认编辑模式为 ir 即时渲染",
      "description": "作为用户，我希望在编辑模式下使用 Vditor 的即时渲染模式 (ir)，而不是分屏模式 (sv)，以便获得更好的编辑体验",
      "acceptanceCriteria": [
        "修改 tauri/src/editor/vditor-editor.ts 中 _buildOptions 方法的默认 mode 参数从 'sv' 改为 'ir'",
        "修改 tauri/src/main.ts 中 _initEditor 方法的 mode 参数从 'sv' 改为 'ir'",
        "编辑器应支持基本的 Markdown 编辑功能（粗体、斜体、标题、列表等）",
        "ir 模式下输入内容即时渲染为格式化文本",
        "pnpm typecheck 通过",
        "pnpm lint 通过"
      ],
      "priority": 1,
      "passes": true,
      "notes": "",
      "dependsOn": [],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-002",
      "title": "移除 Vditor 工具栏的模式切换按钮",
      "description": "作为用户，我不希望在 Vditor 工具栏中看到模式切换按钮，因为应用已经有自己的模式切换机制（编辑/预览/分屏）",
      "acceptanceCriteria": [
        "从 tauri/src/editor/vditor-editor.ts 的 toolbar 配置中移除 'edit-mode' 按钮",
        "工具栏保留其他功能按钮（粗体、斜体、标题、列表、代码、链接、表格等）",
        "确保用户无法通过 Vditor 自带的 UI 切换编辑模式",
        "pnpm typecheck 通过",
        "pnpm lint 通过"
      ],
      "priority": 2,
      "passes": true,
      "notes": "",
      "dependsOn": [
        "US-001"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-003",
      "title": "修复编辑器内容加载问题",
      "description": "作为用户，我希望进入编辑模式时能看到文档内容，而不是空白编辑器",
      "acceptanceCriteria": [
        "修改 tauri/src/main.ts 中 _initEditorIfNeeded 方法，确保切换到编辑/分屏模式时内容正确加载",
        "问题根因：_initEditor() 在 _loadContent() 之前调用，导致 initialValue 为空",
        "解决方案：在 _initEditorIfNeeded 中，无论编辑器是否已初始化，都要确保内容被正确设置",
        "打开文件后切换到编辑模式，内容正确显示",
        "pnpm typecheck 通过",
        "pnpm lint 通过"
      ],
      "priority": 3,
      "passes": true,
      "notes": "",
      "dependsOn": [
        "US-002"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-004",
      "title": "验证编辑模式功能完整性",
      "description": "作为用户，我希望在编辑模式下能够正常打开、编辑和保存文档",
      "acceptanceCriteria": [
        "打开文件时内容正确加载到 Vditor 编辑器",
        "编辑内容时 onChange 回调正常触发",
        "Ctrl+S / Cmd+S 保存功能正常工作",
        "主题切换时编辑器主题同步更新",
        "在 Tauri 桌面应用中验证所有功能正常",
        "pnpm typecheck 通过",
        "pnpm lint 通过"
      ],
      "priority": 4,
      "passes": true,
      "notes": "",
      "dependsOn": [
        "US-003"
      ],
      "completionNotes": "Completed by agent"
    }
  ],
  "metadata": {
    "updatedAt": "2026-02-12T09:18:57.917Z"
  }
}