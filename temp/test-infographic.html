<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Infographic 字体引号编码问题测试</title>
  <style>
    body { 
      font-family: system-ui; 
      padding: 20px;
      background: #f5f5f5;
    }
    #chart {
      background: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 20px;
    }
    pre {
      background: #1e1e1e;
      color: #0f0;
      padding: 15px;
      overflow: auto;
      max-height: 400px;
      border-radius: 4px;
      white-space: pre-wrap;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <h1>Infographic 字体引号编码问题测试</h1>
  
  <div id="chart" style="width:500px;height:400px;"></div>
  
  <h3>SVG 输出中的 font-family 属性:</h3>
  <pre id="svg-output"></pre>

  <script src="https://unpkg.com/@antv/infographic@latest/dist/infographic.min.js"></script>
  <script>
    const syntax = `infographic quadrant-quarter-circular
data
  title 平台技术特征与创新点
  items
    - label 统一连接器接入
      value 90
    - label 去中心化流通
      value 95`;

    const chart = new AntVInfographic.Infographic({
      container: document.getElementById('chart'),
      width: 500,
      height: 400,
      padding: 12,
      themeConfig: {
        base: {
          text: {
            'font-family': "'SimSun', 'Times New Roman', Times, serif"
          }
        }
      }
    });

    chart.on('rendered', async () => {
      // Get SVG output
      const svgDataUrl = await chart.toDataURL({ type: 'svg', embedResources: true });
      const svgContent = decodeURIComponent(svgDataUrl.replace('data:image/svg+xml;charset=utf-8,', ''));
      
      // Extract all font-family occurrences
      const fontFamilyRegex = /font-family[=:]["']?([^"'>;]+)/g;
      const matches = [...svgContent.matchAll(fontFamilyRegex)];
      
      let output = '=== 找到的 font-family 值 ===\n\n';
      matches.forEach((m, i) => {
        output += `${i + 1}. ${m[0]}\n`;
      });
      
      output += '\n=== 完整 SVG (搜索 font-family) ===\n\n';
      output += svgContent;
      
      document.getElementById('svg-output').textContent = output;
    });

    chart.render(syntax);
  </script>
</body>
</html>
